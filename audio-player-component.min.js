(() => {
  // audio-player-component.ts
  var m = {
    aac: "audio/aac",
    caf: "audio/caf; codecs=opus",
    mp3: "audio/mp3",
    mp4: "audio/mp4",
    m4a: "audio/mp4",
    oga: "audio/ogg; codecs=vorbis",
    ogg: "audio/ogg; codecs=vorbis",
    opus: "audio/ogg; codecs=opus",
    wav: "audio/wave",
    webm: "audio/webm"
  }, c = class e extends HTMLElement {
    #i;
    #r;
    #s;
    #t = document.createElement("audio");
    #e = null;
    #a = !1;
    #n = !1;
    #o;
    static get observedAttributes() {
      return [
        "title",
        "artist",
        "image",
        "compact",
        "blurred",
        "min-height",
        "sources",
        "colour",
        "dark",
        "length-secs"
      ];
    }
    static get svgPlay() {
      return '<svg xmlns="https://www.w3.org/2000/svg" width="24" height="24" viewBox="-1 0 23 24"><title>Play</title><polygon class="icon-play" points="19.05 12 6 3.36 6 20.64 19.05 12"/></svg>';
    }
    static get svgPause() {
      return '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><title>Pause</title><g><rect class="icon-pause" x="6" y="3" width="4" height="18"/><rect class="icon-pause" x="14" y="3" width="4" height="18"/></g></svg>';
    }
    static get svgLoading() {
      return '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="loading"><circle cx="12" cy="4" r="2.5"/><circle cx="6" cy="6" r="2.25"/><circle cx="4" cy="12" r="2"/><circle cx="6" cy="18" r="1.75"/><circle cx="12" cy="20" r="1.5"/><circle cx="18" cy="18" r="1.25"/><circle cx="20" cy="12" r="1"/><circle cx="18" cy="6" r="0.75"/></svg>';
    }
    constructor() {
      super(), this.#o = this.attachShadow({ mode: "open" }), this.#i = this.getAttribute("title"), this.#r = this.getAttribute("artist"), this.#s = this.getAttribute("compact") !== null;
      let t = this.getAttribute("preload") ?? "auto";
      (t === "" || t === "none" || t === "auto" || t === "metadata") && (this.#t.preload = t);
      let a = this.getAttribute("sources")?.split(",") ?? [];
      this.loadAudio(a), this.#o.appendChild(e.createElement({ tagName: "style", textContent: this.styleCss })), this.createPlayer();
    }
    static padTime(t) {
      return t < 10 ? `0${t}` : t.toString();
    }
    static createElement({ tagName: t = "div", className: a = "", ...i } = {}) {
      let r = document.createElement(t);
      r.className = a;
      for (let [n, o] of Object.entries(i))
        r[n] = o;
      return r;
    }
    loadAudio(t) {
      if (t.length === 1) {
        this.#t.src = t[0];
        return;
      }
      for (let a of t) {
        let i = a.split(".").pop(), r = m[i ?? "mp3"];
        if (!r) {
          console.warn(`Could not find MIME-type for '${i}' type. Skipping.`);
          continue;
        }
        this.#t.appendChild(
          e.createElement({
            tagName: "source",
            src: a,
            type: r
          })
        );
      }
    }
    get styleCss() {
      return `
		.tap--container {
			width: 100%;
			position: relative;
			display: flex;
			flex-direction: column;
			overflow: hidden;
			border-radius: 32px;
			box-shadow: 0 2px 16px rgba(0, 0, 0, 0.25);
			justify-content: flex-end;
		}

		.tap--overlay {
			background: linear-gradient(rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.5) 100%);
			position: absolute;
			width: 100%;
			height: 100%;
			z-index: -998;
		}

		.tap--img {
			position: absolute;
			width: 100%;
			height: 100%;
			object-fit: cover;
			z-index: -999;
		}

		.tap--img.blurred {
			filter: blur(16px);
		}

		.tap--metadata {
			display: flex;
			flex-direction: column;
			margin: 32px;
			color: #fff;
			user-select: none;
			text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
		}

		.tap--metadata__title {
			font-size: 32px;
			font-weight: 700;
			display: block;
			margin-bottom: 16px;
		}

		.tap--metadata__artist {
			font-size: 28px;
			font-weight: 400;
		}

		.tap--container .tap--controls {
			margin: 0 16px 16px;
		}

		.tap--controls {
			display: flex;
			background-color: var(--audio-player-controls-bg);
			border-radius: 32px;
			height: 64px;
			align-items: center;
			box-shadow: 0 2px 16px rgba(0, 0, 0, 0.25);

			--audio-player-controls-bg: #f9f9f9;
			--audio-player-button: #fff;
			--audio-player-button-hover: #f9f9f9;
			--audio-player-border: #999;
			--audio-player-border-hover: #666;
			--audio-player-progress: #f0f0f0;
			--audio-player-text: #333;
		}
		.tap--controls.dark {
			--audio-player-controls-bg: #222;
			--audio-player-button: #333;
			--audio-player-button-hover: #555;
			--audio-player-border: #aaa;
			--audio-player-border-hover: #bbb;
			--audio-player-progress: #555;
			--audio-player-text: #fff;
		}

		.tap--button {
			cursor: pointer;
			font-size: 24px;
			border-radius: 24px;
			width: 48px;
			height: 48px;
			position: relative;
			margin-left: 8px;
			background-color: var(--audio-player-button);
		}

		.tap--button:hover {
			border: 2px solid var(--audio-player-border-hover);
			background-color: var(--audio-player-button-hover);
		}

		.tap--button,
		.tap--progress--bar {
			border: 2px solid var(--audio-player-border);
		}

		.tap--button svg {
			position: absolute;
			top: 12.5%;
			left: 12.5%;
			width: 75%;
			height: 75%;
			fill: var(--audio-player-text);
		}

		.tap--progress--bar {
			flex: 1;
			height: 24px;
			background-color: var(--audio-player-progress);
			border-radius: 12px;
			margin: 0 12px;
			cursor: pointer;
			position: relative;
			overflow: hidden;
		}

		.tap--progress--playhead {
			border-radius: 0 12px 12px 0;
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			width: 0%;
			pointer-events: none;
			transition: width 0.2s;
		}

		.tap--progress--playhead {
			box-shadow: 0 0 32px rgba(0, 0, 0, 0.75);
		}

		.tap--progress--timestamp {
			font-weight: 700;
			font-family: monospace;
			margin-right: 16px;
			color: var(--audio-player-text);
			user-select: none;
		}

		.loading {
			animation: 1s infinite loading linear;
		}

		@keyframes loading {
			from { transform: rotate(0); }
			to { transform: rotate(360deg); }
		}

		@media (max-width: 640px) {
			.tap--metadata__title {
				font-size: 24px;
			}
			.tap--metadata__artist {
				font-size: 18px;
			}
			.tap--container .tap--controls {
				margin: 8px;
			}
		}
		`;
    }
    addOverlayToContainer(t) {
      if (this.#s) return;
      let a = e.createElement({
        tagName: "img",
        className: "tap--img",
        src: this.getAttribute("image") || ""
      }), i = this.getAttribute("blurred");
      if ((i === null ? !!(this.#i && this.#r) : i !== "false") && a.classList.add("blurred"), t.appendChild(a), !(this.#i && this.#r)) return;
      let n = e.createElement({ className: "tap--overlay" }), o = e.createElement({ className: "tap--metadata" }), d = e.createElement({
        tagName: "span",
        className: "tap--metadata__title",
        innerText: this.#i
      }), l = e.createElement({
        tagName: "span",
        className: "tap--metadata__artist",
        innerText: this.#r
      });
      o.appendChild(d), o.appendChild(l), t.appendChild(n), t.appendChild(o);
    }
    createPlayer() {
      let t = e.createElement({ className: "tap--container" });
      if (!this.#s) {
        let s = Number(this.getAttribute("min-height") ?? 280), p = Number.isSafeInteger(s) ? s : 280;
        t.style.minHeight = `${p}px`;
      }
      this.addOverlayToContainer(t);
      let a = e.createElement({ className: "tap--controls" });
      this.getAttribute("dark") !== null && a.classList.add("dark");
      let i = e.createElement({ className: "tap--progress--bar" }), r = e.createElement({ className: "tap--progress--playhead" }), n = e.createElement({ className: "tap--progress--timestamp" });
      this.#e = e.createElement({
        tagName: "button",
        className: "tap--button"
      }), this.#e.innerHTML = e.svgPlay, r.style.backgroundColor = this.getAttribute("colour") || this.getAttribute("color") || "#3FA9F5";
      let o = () => {
        let s = Number(this.getAttribute("length-secs") ?? 0), p = e.padTime(Math.floor(this.#t.currentTime / 60)), h = e.padTime(Math.floor(this.#t.currentTime % 60)), u = e.padTime(Math.floor((this.#t.duration || s) / 60)), g = e.padTime(Math.floor((this.#t.duration || s) % 60));
        n.innerHTML = `${p}:${h}<br/>${u}:${g}`, r.style.width = `${this.#t.currentTime * 100 / (this.#t.duration || 1)}%`;
      };
      this.#e.onclick = () => {
        if (!(this.#a && !this.#n)) {
          if (!this.#a) return this.play();
          this.pause();
        }
      };
      let d = (s) => {
        let p = s.layerX / s.target.offsetWidth;
        this.#t.fastSeek(this.#t.duration * p);
      }, l = !1;
      if (i.onmousedown = () => {
        l = !0;
      }, i.onmouseup = () => {
        l = !1;
      }, i.onmousemove = (s) => l && d(s), i.onclick = d, i.appendChild(r), a.appendChild(this.#e), a.appendChild(i), a.appendChild(n), o(), this.#t.ondurationchange = o, this.#t.ontimeupdate = o, this.#t.onended = () => {
        this.#t.currentTime = 0, this.#a = !1, this.#e.innerHTML = e.svgPlay;
      }, this.#t.style.display = "none", this.#s) {
        this.#o.appendChild(a);
        return;
      }
      t.appendChild(a), this.#o.appendChild(t);
    }
    async play() {
      this.#a = !0, this.#t.readyState <= 1 && (this.#t.load(), this.#e.innerHTML = e.svgLoading), await this.#t.play(), this.#n = !0, this.#e.innerHTML = e.svgPause;
    }
    pause() {
      this.#t.pause(), this.#a = !1, this.#e.innerHTML = e.svgPlay;
    }
    stop() {
      this.pause(), this.#t.fastSeek(0);
    }
  };
  window.customElements.define("audio-player", c);
})();
