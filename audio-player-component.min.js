(() => {
  // audio-player-component.ts
  var u = {
    aac: "audio/aac",
    caf: "audio/caf; codecs=opus",
    mp3: "audio/mp3",
    mp4: "audio/mp4",
    m4a: "audio/mp4",
    oga: "audio/ogg; codecs=vorbis",
    ogg: "audio/ogg; codecs=vorbis",
    opus: "audio/ogg; codecs=opus",
    wav: "audio/wave",
    webm: "audio/webm"
  }, c = class t extends HTMLElement {
    #e;
    #a;
    #r;
    #s;
    #n;
    #l;
    #p;
    #t = document.createElement("audio");
    #i = !1;
    #o;
    static get observedAttributes() {
      return ["title", "artist", "image", "compact", "blurred", "min-height", "sources", "colour"];
    }
    static get svgPlay() {
      return '<svg xmlns="https://www.w3.org/2000/svg" width="24" height="24" viewBox="-1 0 23 24"><title>Play</title><polygon class="icon-play" points="19.05 12 6 3.36 6 20.64 19.05 12"/></svg>';
    }
    static get svgPause() {
      return '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><title>Pause</title><g><rect class="icon-pause" x="6" y="3" width="4" height="18"/><rect class="icon-pause" x="14" y="3" width="4" height="18"/></g></svg>';
    }
    constructor() {
      super(), this.#o = this.attachShadow({ mode: "open" }), this.#e = this.getAttribute("title"), this.#a = this.getAttribute("artist"), this.#r = this.getAttribute("image") || "", this.#s = this.getAttribute("compact") !== null, this.#n = this.getAttribute("blurred") !== "false" || !(this.#e && this.#a), this.#p = this.getAttribute("colour") || "#3FA9F5";
      let e = Number(this.getAttribute("min-height") ?? 280);
      this.#l = Number.isSafeInteger(e) ? e : 280;
      let a = this.getAttribute("sources")?.split(",") ?? [];
      this.loadAudio(a), this.#o.appendChild(t.createElement({ tagName: "style", textContent: this.styleCss })), this.createPlayer();
    }
    static padTime(e) {
      return e < 10 ? `0${e}` : e.toString();
    }
    static createElement({ tagName: e = "div", className: a = "", ...i } = {}) {
      let s = document.createElement(e);
      s.className = a;
      for (let [r, o] of Object.entries(i))
        s[r] = o;
      return s;
    }
    loadAudio(e) {
      for (let a of e) {
        let i = a.split(".").pop(), s = u[i ?? "mp3"];
        if (!s) {
          console.warn(`Could not find MIME-type for '${i}' type. Skipping.`);
          continue;
        }
        this.#t.appendChild(
          t.createElement({
            tagName: "source",
            src: a,
            type: s
          })
        );
      }
      this.#t.load();
    }
    get styleCss() {
      return `
		.tap--container {
			width: 100%;
			position: relative;
			display: flex;
			flex-direction: column;
			overflow: hidden;
			border-radius: 32px;
			box-shadow: 0 2px 16px rgba(0, 0, 0, 0.25);
			justify-content: flex-end;
		}

		.tap--overlay {
			background: linear-gradient(rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.5) 100%);
			position: absolute;
			width: 100%;
			height: 100%;
			z-index: -998;
		}

		.tap--img {
			position: absolute;
			width: 100%;
			height: 100%;
			object-fit: cover;
			z-index: -999;
		}

		.tap--img.blurred {
			filter: blur(16px);
		}

		.tap--metadata {
			display: flex;
			flex-direction: column;
			margin: 32px;
			color: #fff;
			user-select: none;
			text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
		}

		.tap--metadata__title {
			font-size: 32px;
			font-weight: 900;
			display: block;
			margin-bottom: 16px;
		}

		.tap--metadata__artist {
			font-size: 28px;
			font-weight: 700;
		}

		.tap--container .tap--controls {
			margin: 0 16px 16px;
		}

		.tap--controls {
			display: flex;
			background-color: #f9f9f9;
			border-radius: 32px;
			height: 64px;
			align-items: center;
			box-shadow: 0 2px 16px rgba(0, 0, 0, 0.25);
		}

		.tap--button {
			cursor: pointer;
			border: 0;
			font-size: 24px;
			border-radius: 24px;
			width: 48px;
			height: 48px;
			position: relative;
			background-color: #fff;
			margin-left: 8px;
		}

		.tap--button:hover {
			background-color: #f9f9f9;
			border: 2px solid #666;
		}

		.tap--button,
		.tap--progress--bar {
			border: 2px solid #999;
		}

		.tap--button svg {
			position: absolute;
			top: 12.5%;
			left: 12.5%;
			width: 75%;
			height: 75%;
			fill: #333;
		}

		.tap--progress--bar {
			flex: 1;
			height: 24px;
			background-color: #f0f0f0;
			border-radius: 12px;
			margin: 0 12px;
			cursor: pointer;
			position: relative;
			overflow: hidden;
		}

		.tap--progress--playhead {
			border-radius: 0 12px 12px 0;
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			width: 0%;
			pointer-events: none;
			transition: width 0.2s;
		}

		.tap--progress--playhead {
			box-shadow: 0 0 32px rgba(0, 0, 0, 0.75);
		}

		.tap--progress--timestamp {
			font-weight: 700;
			font-family: monospace;
			margin-right: 16px;
			color: #333;
			user-select: none;
		}

		@media (max-width: 640px) {
			.tap--metadata__title {
				font-size: 24px;
			}
			.tap--metadata__artist {
				font-size: 18px;
			}
			.tap--container .tap--controls {
				margin: 8px;
			}
		}
		`;
    }
    addOverlayToContainer(e) {
      if (this.#s) return;
      let a = t.createElement({
        tagName: "img",
        className: "tap--img",
        src: this.#r
      });
      if (this.#n && a.classList.add("blurred"), e.appendChild(a), !(this.#e && this.#a)) return;
      let i = t.createElement({ className: "tap--overlay" }), s = t.createElement({ className: "tap--metadata" }), r = t.createElement({
        tagName: "span",
        className: "tap--metadata__title",
        innerText: this.#e
      }), o = t.createElement({
        tagName: "span",
        className: "tap--metadata__artist",
        innerText: this.#a
      });
      s.appendChild(r), s.appendChild(o), e.appendChild(i), e.appendChild(s);
    }
    createPlayer() {
      let e = t.createElement({ className: "tap--container" });
      this.#s || (e.style.minHeight = `${this.#l}px`), this.addOverlayToContainer(e);
      let a = t.createElement({ className: "tap--controls" }), i = t.createElement({ className: "tap--progress--bar" }), s = t.createElement({ className: "tap--progress--playhead" }), r = t.createElement({ className: "tap--progress--timestamp" }), o = t.createElement({ tagName: "button", className: "tap--button" });
      o.innerHTML = t.svgPlay, s.style.backgroundColor = this.#p;
      let l = () => {
        let n = t.padTime(Math.floor(this.#t.currentTime / 60)), d = t.padTime(Math.floor(this.#t.currentTime % 60)), g = t.padTime(Math.floor((this.#t.duration || 0) / 60)), m = t.padTime(Math.floor((this.#t.duration || 0) % 60));
        r.innerHTML = `${n}:${d}<br/>${g}:${m}`, s.style.width = `${this.#t.currentTime * 100 / (this.#t.duration || 1)}%`;
      };
      o.onclick = () => {
        if (!this.#i) {
          this.#t.play(), this.#i = !0, o.innerHTML = t.svgPause;
          return;
        }
        this.#t.pause(), this.#i = !1, o.innerHTML = t.svgPlay;
      };
      let h = (n) => {
        let d = n.layerX / n.target.offsetWidth;
        this.#t.fastSeek(this.#t.duration * d);
      }, p = !1;
      if (i.onmousedown = () => {
        p = !0;
      }, i.onmouseup = () => {
        p = !1;
      }, i.onmousemove = (n) => p && h(n), i.onclick = h, i.appendChild(s), a.appendChild(o), a.appendChild(i), a.appendChild(r), l(), this.#t.ondurationchange = l, this.#t.ontimeupdate = l, this.#t.onended = () => {
        this.#t.currentTime = 0, this.#i = !1, o.innerHTML = t.svgPlay;
      }, this.#t.style.display = "none", this.#s) {
        this.#o.appendChild(a);
        return;
      }
      e.appendChild(a), this.#o.appendChild(e);
    }
  };
  window.customElements.define("audio-player", c);
})();
